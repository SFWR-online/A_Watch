#include"main.h"
#include"gpio.h"
#include "oled.h"
#include "u8g2.h"
#include"allmath.h"
#include "stdlib.h"

int button_turn();
int button_sure();
int button_return();
int button_other1();
int button_other2();
int get_tem();
void fresh_bat(int bat,u8g2_t u8g2);
void display_page_time(int time[],u8g2_t u8g2);
void display_card(u8g2_t u8g2,int nowcard[]);
void play_card(u8g2_t u8g2,int seed);
void display_page_init(u8g2_t u8g2);
int p1_reline[15],p1[15],p2[15],p1_flag[15],p1_line[15],p2_line[15];
int set_card_pos,p2_len,rand_cnt,p1_card,p2_card;
void refresh_card(u8g2_t u8g2,int set_pos[15][2]);
void let_p2();
void card_init(int seed);
void display_page_music(u8g2_t u8g2,int music_pos);
void delay_us(uint32_t udelay);
void display_music(int music_pos);
void broadcast_music(int music_p[],int music_l[]);
static const unsigned char start_pic[] = {
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0x1f, 0x7c, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0x07, 0x7c, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0xe0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x70, 0x00, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0x0f, 0xf0, 0xff, 0xc7, 0xff, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xc1, 0xff, 0xff, 0xff, 0x0f, 0x1e, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x3f, 0xf8, 0xff, 0x7f, 0xfc, 0x7f, 0xf0, 0xe1, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x8f, 0xe3, 0xff, 0x1f, 0xff, 0xff, 0xc3, 0x8f, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xe3, 0xf8, 0xf7, 0xc7, 0xbf, 0xff, 0x1f, 0x3f, 0xfe, 0xe1, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x38, 0xfe, 0xf1, 0xf1, 0xbf, 0xff, 0x3f, 0xf8, 0x60, 0xc4, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0x3f, 0x8e, 0x7f, 0x7c, 0xfc, 0xbf, 0xff, 0xff, 0x00, 0x00, 0x0f, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0x1f, 0xc3, 0x3f, 0x1f, 0xfe, 0xbf, 0xf7, 0xfb, 0x39, 0x02, 0x3f, 0xfe, 0xff, 0xff,
		  0xff, 0xff, 0xcf, 0xe0, 0x8c, 0x0f, 0xff, 0x3f, 0xf7, 0xfb, 0xf3, 0x08, 0x7c, 0xfc, 0xff, 0xff,
		  0xff, 0xff, 0x27, 0x70, 0xc6, 0x83, 0xff, 0x3f, 0xf6, 0xfb, 0x83, 0x03, 0xfc, 0xf8, 0xff, 0xff,
		  0xff, 0xff, 0x13, 0x38, 0xf3, 0xd8, 0xff, 0x1f, 0xf4, 0xfb, 0x27, 0x04, 0xe0, 0xf9, 0xff, 0xff,
		  0xff, 0xff, 0x41, 0x9c, 0x79, 0x4c, 0xff, 0x1f, 0xf0, 0xfb, 0x67, 0x20, 0x04, 0xf3, 0xff, 0xff,
		  0xff, 0xff, 0x60, 0xce, 0x39, 0x6f, 0xff, 0x4f, 0xe0, 0xfb, 0x0f, 0x33, 0x3c, 0xe4, 0xff, 0xff,
		  0xff, 0xff, 0x38, 0xe7, 0x3c, 0x2c, 0xff, 0xe7, 0xe1, 0xf3, 0xcf, 0x39, 0xfc, 0xe0, 0xff, 0xff,
		  0xff, 0x7f, 0x3c, 0x73, 0x9e, 0xa0, 0x83, 0xf3, 0xef, 0xf3, 0xcf, 0x0c, 0xfc, 0xe3, 0xff, 0xff,
		  0xff, 0x7f, 0x0e, 0x79, 0xcb, 0xaf, 0xbf, 0xf3, 0xef, 0xfb, 0x0f, 0x06, 0xf8, 0xcf, 0xff, 0xff,
		  0xff, 0x0f, 0x80, 0x7d, 0xc1, 0x8c, 0xff, 0x01, 0x2c, 0xfb, 0x8f, 0x01, 0xf1, 0x9f, 0xff, 0xff,
		  0xff, 0x3f, 0x90, 0x7c, 0x01, 0x80, 0x9f, 0xfc, 0x87, 0xf9, 0x03, 0x90, 0xe3, 0x3f, 0xff, 0xff,
		  0xff, 0x7f, 0x9e, 0x7e, 0x06, 0x88, 0x4f, 0xfe, 0x87, 0xf9, 0x27, 0x9f, 0xc7, 0x3f, 0xff, 0xff,
		  0xff, 0x7f, 0x1e, 0xfe, 0x34, 0x80, 0x07, 0x80, 0xc7, 0xfc, 0x0f, 0xcc, 0x9f, 0x7f, 0xfe, 0xff,
		  0xff, 0xff, 0x3e, 0xfb, 0x30, 0x00, 0x83, 0x2f, 0x47, 0xfc, 0x27, 0xc0, 0x3f, 0x7f, 0xfe, 0xff,
		  0xff, 0xff, 0x3f, 0x79, 0x60, 0x20, 0x21, 0x00, 0x20, 0xfc, 0xf7, 0x01, 0x78, 0xce, 0xfc, 0xff,
		  0xff, 0xff, 0x3f, 0x71, 0x78, 0x60, 0x3c, 0x00, 0x00, 0xf8, 0xf3, 0xe7, 0xff, 0xcc, 0xfc, 0xff,
		  0xff, 0xff, 0x3f, 0x71, 0x78, 0xe6, 0xfc, 0x1f, 0x00, 0xfc, 0xf9, 0xe7, 0xff, 0xd9, 0xfc, 0xff,
		  0xff, 0xff, 0x3f, 0xf1, 0xf8, 0xfc, 0xff, 0x1f, 0x00, 0xff, 0xfd, 0xe7, 0xff, 0xd9, 0xf8, 0xff,
		  0xff, 0xff, 0x7f, 0xe5, 0xf8, 0xff, 0xff, 0x1f, 0x00, 0xff, 0xfc, 0xe7, 0xff, 0x93, 0xe0, 0xff,
		  0xff, 0xff, 0x7f, 0xcc, 0xe0, 0xff, 0xff, 0x3f, 0x03, 0x3e, 0x78, 0xe7, 0xff, 0x47, 0x00, 0xff,
		  0xff, 0xff, 0xff, 0x98, 0x81, 0xff, 0xff, 0xff, 0x01, 0x1f, 0x7a, 0xe6, 0xff, 0x4f, 0xfe, 0xff,
		  0xff, 0xff, 0xff, 0x30, 0x10, 0x98, 0xff, 0x1f, 0xc0, 0xcf, 0xf9, 0xe6, 0xff, 0x0f, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x43, 0x10, 0x00, 0xfc, 0x3f, 0xf1, 0x03, 0xfc, 0xec, 0xff, 0x8f, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xc1, 0x00, 0x00, 0x00, 0x98, 0x80, 0xff, 0xc9, 0xff, 0x87, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xc7, 0x00, 0x00, 0x00, 0x02, 0x0e, 0xff, 0xc3, 0xff, 0xe3, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0x00, 0x00, 0x80, 0x7f, 0xfe, 0x87, 0xff, 0xf0, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0x00, 0x00, 0xf0, 0xff, 0xfc, 0x1f, 0x0f, 0xfe, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0x98, 0xff, 0xff, 0xf1, 0x7e, 0xfc, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0x18, 0x00, 0x00, 0xc0, 0xff, 0xff, 0xe7, 0xfc, 0xf1, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x3f, 0x1e, 0x00, 0xcc, 0xc7, 0xff, 0xff, 0x0f, 0xf9, 0xc7, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x1f, 0x27, 0x04, 0x9f, 0xc1, 0xff, 0xf9, 0x3f, 0xf0, 0x1f, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xcf, 0x23, 0x00, 0x3e, 0xcc, 0xff, 0xf3, 0xff, 0xc1, 0x3f, 0xfe, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xe7, 0x31, 0x81, 0x00, 0x00, 0xff, 0xe7, 0x73, 0x07, 0xff, 0xf8, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x73, 0x34, 0x81, 0x90, 0x00, 0xfe, 0xc7, 0x77, 0x0e, 0xfc, 0xf1, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x3b, 0x27, 0xd1, 0x1c, 0x03, 0xfc, 0xc7, 0x77, 0xcc, 0xf1, 0xe3, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x99, 0x27, 0xc1, 0x3b, 0x00, 0xb0, 0xd3, 0x77, 0xdc, 0xc7, 0xcf, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xcd, 0x0f, 0x81, 0x71, 0x00, 0x90, 0x91, 0x77, 0xd8, 0x1f, 0xcf, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xed, 0x1f, 0x00, 0x00, 0x02, 0x88, 0x98, 0x33, 0xd9, 0x7f, 0xde, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xe1, 0x3f, 0x00, 0x20, 0x00, 0x03, 0x9e, 0x83, 0xcb, 0xff, 0xdc, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xe1, 0x7f, 0x48, 0x00, 0x00, 0x00, 0x9f, 0xe1, 0xe3, 0xff, 0xcc, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xc3, 0xff, 0x81, 0xf9, 0x00, 0xe1, 0x5f, 0xf8, 0xf0, 0xff, 0xe5, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x0f, 0xe0, 0x1f, 0xf1, 0xe1, 0xff, 0x00, 0x7e, 0xfc, 0xf3, 0xf0, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0x3f, 0xf0, 0x3f, 0x06, 0x87, 0xff, 0xe1, 0xff, 0xff, 0x03, 0xfc, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0x7f, 0x3c, 0x00, 0xfe, 0xff, 0xff, 0xff, 0x8f, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x78, 0x03, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x03, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x07, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x0f, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
		  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x3f, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff
};
static const unsigned char  tem_pic[] = {
		 0x00, 0xf0, 0x0f, 0x00, 0x00, 0xfe, 0x7f, 0x00, 0x00, 0x7f, 0xfe, 0x00, 0xc0, 0x07, 0xe0, 0x03,
		  0xe0, 0x01, 0x80, 0x07, 0xf0, 0xc0, 0x03, 0x0e, 0x38, 0x40, 0x02, 0x1c, 0x18, 0x00, 0x00, 0x38,
		  0x1c, 0x80, 0x31, 0x38, 0x0e, 0x80, 0x01, 0x70, 0x0e, 0x80, 0x21, 0x70, 0x06, 0x80, 0x21, 0x60,
		  0x07, 0x80, 0x01, 0xe0, 0x07, 0x80, 0x21, 0xe0, 0x07, 0x80, 0x01, 0xc0, 0x03, 0x80, 0x01, 0xc0,
		  0x03, 0x80, 0x31, 0xc0, 0x07, 0x80, 0x01, 0xc0, 0x07, 0xa0, 0x05, 0xe0, 0x07, 0x90, 0x09, 0xe0,
		  0x06, 0xe8, 0x03, 0x60, 0x0e, 0xe8, 0x17, 0x70, 0x0e, 0xe8, 0x17, 0x70, 0x1c, 0xe8, 0x17, 0x38,
		  0x18, 0xc0, 0x0b, 0x38, 0x38, 0x90, 0x0c, 0x1c, 0x70, 0x60, 0x03, 0x0e, 0xe0, 0x01, 0x80, 0x07,
		  0xc0, 0x07, 0xe0, 0x03, 0x00, 0x3f, 0xfc, 0x01, 0x00, 0xfe, 0x7f, 0x00, 0x00, 0xf0, 0x0f, 0x00
};
static const unsigned char set_pic[]={
		 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		  0x00, 0xc0, 0x03, 0x00, 0x00, 0xc0, 0x03, 0x00, 0x00, 0xc1, 0xc3, 0x00, 0x80, 0xe7, 0xe7, 0x01,
		  0xc0, 0xff, 0xff, 0x03, 0xc0, 0xff, 0xff, 0x03, 0x80, 0xff, 0xff, 0x01, 0x00, 0x3f, 0xfc, 0x00,
		  0x00, 0x0f, 0xf0, 0x00, 0x80, 0x0f, 0xf0, 0x01, 0xf0, 0x87, 0xe1, 0x0f, 0xf0, 0xc7, 0xe3, 0x0f,
		  0xf0, 0xc7, 0xe3, 0x0f, 0xf0, 0x87, 0xe1, 0x0f, 0x80, 0x0f, 0xf0, 0x01, 0x00, 0x0f, 0xf0, 0x00,
		  0x00, 0x3f, 0xfc, 0x00, 0x80, 0xff, 0xff, 0x01, 0xc0, 0xff, 0xff, 0x01, 0xc0, 0xff, 0xff, 0x03,
		  0x80, 0xe7, 0xe7, 0x01, 0x00, 0xc3, 0xc3, 0x00, 0x00, 0xc0, 0x03, 0x00, 0x00, 0xc0, 0x03, 0x00,
		  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
static const unsigned char card_pic[] = {
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x3e, 0x00, 0x00, 0x80, 0x63, 0x7c, 0x00, 0x60, 0x40, 0xe4, 0x07, 0x1c, 0x40, 0xe6, 0x7f,
  0x06, 0x80, 0xfe, 0x7f, 0x09, 0x00, 0xfe, 0x7f, 0x0f, 0x00, 0xfe, 0x7f, 0x02, 0x00, 0xff, 0x7f,
  0x02, 0x00, 0xff, 0x7f, 0x04, 0x00, 0xff, 0x3f, 0x04, 0x06, 0x1f, 0x3f, 0x08, 0x9c, 0x0f, 0x3f,
  0x08, 0x9e, 0x0f, 0x3e, 0x18, 0x8e, 0x1f, 0x1f, 0x10, 0x80, 0xdf, 0x1f, 0x10, 0xc0, 0xff, 0x1f,
  0x20, 0xc0, 0xff, 0x0f, 0x20, 0xc0, 0xff, 0x0f, 0x40, 0xc0, 0xff, 0x0f, 0x40, 0xe0, 0xff, 0x0f,
  0x40, 0xc0, 0xff, 0x07, 0x80, 0x80, 0xff, 0x04, 0x80, 0x10, 0xf8, 0x06, 0x00, 0x0f, 0x80, 0x03,
  0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
static const unsigned char music_pic[] = {
  0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0xfc, 0x3f, 0x00, 0xe0, 0xff, 0x3f, 0x00, 0xfe, 0xff, 0x3f,
  0x00, 0xff, 0xff, 0x3f, 0x00, 0xff, 0xff, 0x3f, 0x00, 0xff, 0xff, 0x3f, 0x00, 0xff, 0x0f, 0x38,
  0x00, 0x3f, 0x00, 0x38, 0x00, 0x07, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38, 0x00, 0x07, 0x00, 0x38,
  0x00, 0x07, 0x00, 0x38, 0x00, 0x07, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38,
  0x00, 0x03, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38,
  0x00, 0x03, 0x00, 0x38, 0x00, 0x03, 0x00, 0x38, 0x00, 0x03, 0x80, 0x3f, 0x00, 0x03, 0xe0, 0x3f,
  0xf0, 0x03, 0xf0, 0x3f, 0xfc, 0x03, 0xf8, 0x3f, 0xfe, 0x03, 0xf8, 0x1f, 0xfe, 0x03, 0xf8, 0x0f,
  0xff, 0x03, 0xf8, 0x07, 0xff, 0x01, 0xe0, 0x01, 0xfe, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00
};
static const unsigned int music_tone[]={0,262,286,311,349,392,440,494,523,587,659,698,784,880,987,1046,1174,1318,1396,1567,1760,1975};
static const unsigned int music_1_p[]={
		0,8,6,7,8,
		10,12,12,10,5,10,9,8,9,7,7,8,7,6,8,6,7,8,
		10,12,13,10,5,12,11,10,10,8,8,9,10,9,8,6,5,6,5,6,6,10,5,
		6,5,6,5,6,6,10,10,10,9,9,8,8,8,9,11,11,10,11,12,10,9,8,
		9,10,10,9,8,9,10,10,10,10,10,10,10,10,12,12,10,9,10,9,8,8,8,8,9,10,
		11,10,11,12,10,5,12,8,8,7,8,13,12,8,8,7,8,9,10,10,6,6,8,8,7,8,
		13,12,12,12,10,9,8,9,10,10,9,8,9,10,10,10,10,10,10,10,10,12,12,10,9,10,
		9,8,10,8,9,10,11,10,11,12,10,5,12,8,8,7,8,13,12,8,7,8,9,10,
		10,6,6,8,8,7,8,12,8,8,7,7,8,7,0,0,0};
static const unsigned int music_1_l[]={
		0,2,2,4,4,
		6,1,2,4,1,1,1,2,2,2,4,2,2,2,2,2,4,4,
		6,1,3,4,1,1,2,1,2,2,2,5,2,2,2,2,2,2,1,1,2,2,2,
		2,2,2,1,1,2,2,2,2,2,2,1,1,2,2,2,2,2,2,6,1,1,1,
		2,2,1,1,1,2,2,1,1,2,1,1,1,2,1,2,2,2,2,2,1,1,4,2,2,2,
		2,2,2,4,2,2,4,2,2,2,1,2,4,2,2,2,1,1,1,2,2,2,2,2,2,2,
		2,2,2,5,1,1,1,2,2,1,1,1,2,2,1,1,2,1,1,1,2,1,2,2,2,2,
		5,1,1,2,2,2,2,2,2,4,2,2,4,2,2,2,1,2,5,2,2,1,1,1,
		2,2,2,2,2,2,2,4,4,2,2,2,2,6};
static const int music_2_p[]={
		0,8,9,10,8,8,9,10,8,10,11,12,
		10,11,12,12,13,12,11,10,8,12,13,12,11,10,8,
		10,5,8,9,5,8,0,0,0
};
static const int music_2_l[]={
		0,4,4,4,4,4,4,4,4,4,4,6,
		4,4,6,2,2,2,2,4,4,2,2,2,2,4,4,
		4,4,6,4,4,6
};

